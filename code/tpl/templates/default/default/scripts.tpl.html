
<script src="assets/js/plugins/canvas-to-blob.min.js" type="text/javascript"></script>

<script src="assets/js/plugins/purify.min.js" type="text/javascript"></script>
<!-- the main fileinput plugin file -->
<script src="assets/js/fileinput.min.js"></script>
<script src="assets/js/locales/ru.js"></script>

<style>
  .file-upload-indicator,
  .file-actions
  {
    display: none;
  }
</style>

<script>
$(document).ready(function() {
  $("#input-dim-2").fileinput({
      uploadUrl: "/ajax/image-upload",
      allowedFileExtensions: ["jpeg", "jpg", "png", "gif"],
      allowedFileTypes: ['image'],
      maxImageWidth: 320,
      maxImageHeight: 240,
      language: "ru",
      browseOnZoneClick: true,
      resizeImage: true,
      resizePreference: 'height',
      showUpload: false,
      fileActionSettings: {
        showUpload: false,
        showRemove: false,
        showZoom: false,
      }

  //}).on('fileimageloaded', function(event, previewId) {
  //  console.log("fileimageloaded");
  }).on('filecleared', function(event) {
    imgSrc = "assets/img/placeholder-320x240.png";
    $('#preview-img').attr('src', imgSrc);
  });

  $('#preview-btn').on('click', function() {
    //let blob = $('#input-dim-2').fileinput('getFileStack');
    //let urlCreator = window.URL || window.webkitURL;
    //let imgSrc = urlCreator.createObjectURL(new Blob([blob], { type: "image/jpeg" }));
    let imgSrc = $('.file-preview-image').attr('src');

    if (!imgSrc) {
      imgSrc = "assets/img/placeholder-320x240.png";
    }
    $('#preview-img').attr('src', imgSrc);


    let feedback = $('#feedback').html().replace(/\n/g, "<br />");
    $('#feedback-preview-body').html(feedback);
    $('#feedback-preview-title').html($('#name').val());

    $('#feedback-preview').show();
    //$("#input-dim-2").fileinput('upload');

  });

  $('#submit-btn').on('click', function() {
    alert('Yo!');
  });
});
</script>
